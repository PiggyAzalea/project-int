<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PPTX Preview</title>
<style>
  #slides-container {
    width: 800px;
    height: 600px;
    margin: auto;
    overflow: hidden;
    position: relative;
  }
  .slide {
    display: none;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }
  .btn {
    margin: 10px;
    padding: 5px 10px;
    background-color: #007bff;
    color: #fff;
    border: none;
    cursor: pointer;
  }
</style>
</head>
<body>
  <input type="file" id="fileInput">
  <div id="slides-container"></div>
  <button class="btn" id="prevBtn">Previous</button>
  <button class="btn" id="nextBtn">Next</button>

<script>
 <script>
  document.getElementById('fileInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();

    reader.onload = function(e) {
      const pptxData = new Uint8Array(e.target.result);
      const zip = new JSZip(pptxData);
      const slides = [];

      zip.forEach(function(relativePath, zipEntry) {
        if (relativePath.startsWith('ppt/slides/slide')) {
          slides.push(zipEntry.async('uint8array'));
        }
      });

      Promise.all(slides).then(function(slideContents) {
        const slidesContainer = document.getElementById('slides-container');
        slidesContainer.innerHTML = '';

        slideContents.forEach(function(content, index) {
          const slideDiv = document.createElement('div');
          slideDiv.classList.add('slide');
          slideDiv.innerHTML = `
            <img src="data:image/svg+xml;base64,${btoa(String.fromCharCode.apply(null, content))}" alt="Slide ${index + 1}">
          `;
          slidesContainer.appendChild(slideDiv);
        });

        showSlide(0);
      });
    };

    reader.readAsArrayBuffer(file);
  });

  let currentSlideIndex = 0;

  function showSlide(index) {
    const slides = document.querySelectorAll('.slide');
    slides.forEach(function(slide) {
      slide.style.display = 'none';
    });
    slides[index].style.display = 'block';
    currentSlideIndex = index;
  }

  document.getElementById('prevBtn').addEventListener('click', function() {
    if (currentSlideIndex > 0) {
      showSlide(currentSlideIndex - 1);
    }
  });

  document.getElementById('nextBtn').addEventListener('click', function() {
    const slides = document.querySelectorAll('.slide');
    if (currentSlideIndex < slides.length - 1) {
      showSlide(currentSlideIndex + 1);
    }
  });
</script>

</script>
</body>
</html>
